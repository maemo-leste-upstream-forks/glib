From: Markus Koschany <apo@debian.org>
Date: Wed, 3 Jul 2019 14:41:18 +0200
Subject: CVE-2019-13012

Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=931234
Bug-Upstream: https://gitlab.gnome.org/GNOME/glib/issues/1658
Origin: https://gitlab.gnome.org/GNOME/glib/commit/5e4da714f00f6bfb2ccd6d73d61329c6f3a08429
---
 gio/gkeyfilesettingsbackend.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/gio/gkeyfilesettingsbackend.c
+++ b/gio/gkeyfilesettingsbackend.c
@@ -640,7 +640,7 @@
 
   kfsb->file = g_file_new_for_path (filename);
   kfsb->dir = g_file_get_parent (kfsb->file);
-  g_file_make_directory_with_parents (kfsb->dir, NULL, NULL);
+  g_mkdir_with_parents (g_file_get_path (kfsb->dir), 0700);
 
   kfsb->file_monitor = g_file_monitor (kfsb->file, 0, NULL, NULL);
   kfsb->dir_monitor = g_file_monitor (kfsb->dir, 0, NULL, NULL);
